define(["angular"],function(e){return function(e,o,r,t){e.controller("borrowPreviewCtrl",["$state","$stateParams","$scope","cService","$location","popupDialog","$rootScope",function(e,o,r,t,a,i,n){var s=o.id,g=(a.$$search.userId,"borrows/"+s+"?preview=preview"),u="investments?preview=preview";!function(){t.ajax({url:g,method:"get"}).success(function(e){r.borrowData=e,e.status>=3?r.investStatus=2:n.user.id==e.userBaseInfoRes.userId?r.investStatus=3:r.investStatus=1,r.userinfo=e.userBaseInfoRes?e.userBaseInfoRes:{},r.borrowImageList=e.borrowImageList?e.borrowImageList:[],r.imagePagingAction(1),r.headPortraitUrl=("default-protrait.png"!=r.userinfo.headPortraitUrl?n.domain+r.userinfo.headPortraitUrl+"?imageView2/1/w/90/h/90&t="+(new Date).getTime():"resources/images/user-portrait.gif")+"?t="+(new Date).getTime(),r.borrowData.amountBorrow-r.borrowData.amountInvested<=r.borrowData.investMin&&(r.disabledInput=!0,r.investValue=r.borrowData.amountBorrow-r.borrowData.amountInvested)})}(),r.imagePageSize=3,r.imageData=[],r.imagePagingAction=function(e){r.imageData=[];for(var o=(e-1)*r.imagePageSize;o<e*r.imagePageSize&&r.borrowImageList[o];o++)r.imageData.push(r.borrowImageList[o]);r.imageTotal=r.borrowImageList.length},r.recordPage=1,r.recordPageSize=10,r.recordTotal=0,(r.getInvestmentList=function(e){t.ajax({url:u,method:"get",params:{page:e,rows:r.recordPageSize,borrowId:s}}).success(function(e){r.investmentList=e.rows,r.recordTotal=e.total,console.log(e.rows)})})(1),r.reload=function(){location.reload()},r.returnWindow=function(){history.go(-1)},r.gotoAnchor=t.gotoAnchor}])}});