define(["angular"],function(e){return function(t){t.run(["$rootScope","$state","$stateParams","$location",function(e,t,r,n){e.$on("$locationChangeStart",function(r){Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,r=Number(arguments[1])||0;for(r=0>r?Math.ceil(r):Math.floor(r),0>r&&(r+=t);t>r;r++)if(r in this&&this[r]===e)return r;return-1}),t.includes("account")&&""==e.user.name})}]).run(["validator","defaultErrorMessageResolver",function(e,t){t.getErrorMessages().then(function(e){e.required="必填项",e.minlength="输入不能少于{0}个字符",e.maxlength="输入不能多于{0}个字符",e.pattern="格式不正确",e.email="邮箱格式不正确",e.number="输入必须是数字",e.url="格式不正确",e.min="输入不能小于{0}",e.max="输入不能大于{0}",e.dymin="输入不能小于{0}",e.dymax="输入不能大于{0}",e.loginError="用户名或者密码错误",e.validateError="验证码不能为空",e.repeat="两次密码不一致",e.repeatCode="两次账号不一致",e.investValidate="余额不足{0}<a>请充值</a>",e.ProtocolError="请勾选协议",e.UserError="请输入4-16位字符,由英文字母、数字组成,且不能为纯数字",e.recommendError="请输入4-16位字符,由英文字母、数字组成",e.EmailError="请输入正确的邮箱",e.PhoneError="请输入正确的手机号码",e.PasswordError="请输8~16位数字及英文字母，其中至少包含一个字母和一个数字",e["remote-user"]="该用户名已被注册，请重新输入",e["remote-email"]="该邮箱已被绑定，请重新输入",e["remote-phone"]="该手机号码已被注册，请重新输入",e.WithdrawError="请输入正确的金额，金额最多带两位小数",e.RechargeError="请输入正确的金额，金额为整数",e.Integer="请输入一个整数",e.Float="只能输入数字，最多带两位小数",e.realName="格式不正确，请输入真实姓名",e.MonthInteger="请输入一个不超过36的月份数",e.DayInteger="请输入一个3位以内的天数",e.loginRequired1="用户名不能为空",e.loginRequired2="密码不能为空",e["remote-friend"]="好友推荐人不存在",e.minUser="用户名不能小于4位",e.invalidcharacter="存在非法字符!"}),e.setValidElementStyling(!1)}]).factory("G",["$rootScope","$window","$injector","$location","$cookieStore",function(t,r,n,o,i){function a(){this.interfaceType=1,this.user={}}a.prototype={construtor:a,init:function(e,t,r){},useMockInterface:function(e){this.interfaceType=e},jumpLoginPage:function(){var e=n.get("$state");return t.login.beforeLogin=!0,t.login.afterLogin=!1,e.go("login"),!1},jumpErrorPage:function(e){var t=n.get("$state");return t.go("error",{status:e.status}),!1},index:function(e,t){for(var r=0;r<t.length;r++)if(t[r]==e)return r;return null},getIndex:function(e){for(var t=0;null!=(e=e.previousSibling);)1==e.nodeType&&t++;return t},getElement:function(e,t,r){for(var n=e.getElementsByTagName(r),o=[],i=0;i<n.length;i++)for(var a=0,s=n[i].className.split(" ");a<s.length;a++)if(s[a]==t){o.push(n[i]);break}return o},reSetNav:function(){var e=document.getElementById("main-nav"),r=this.getElement(e,"borrow","li");if(t.user.id&&t.user.canBorrow)for(var n=0;n<r.length;n++)r[n].style.display="block";else for(var n=0;n<r.length;n++)r[n].style.display="none"},getBrowser:function(){function e(e){e=e.toLowerCase();var r=t.exec(e)||n.exec(e)||o.exec(e)||e.indexOf("compatible")<0&&i.exec(e)||[];return{browser:r[1]||"",version:r[2]||"0"}}var t=/(webkit)[ \/]([\w.]+)/,n=/(opera)(?:.*version)?[ \/]([\w.]+)/,o=/(msie) ([\w.]+)/,i=/(mozilla)(?:.*? rv:([\w.]+))?/,a=r.navigator.userAgent;return e(a)},isIE8:function(){var e=this.getBrowser();return"msie"==e.browser&&"8.0"==e.version},updateMessageAmount:function(){var e=n.get("cService");e.ajax({url:"user/message",method:"get"}).success(function(e){t.user.isNotReadedMessage=e;var r=t.user;i.put("curUser",r)})},GetCurrentStyle:function(e,t){if(e.currentStyle)return t=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),e.currentStyle[t];if(document.defaultView&&document.defaultView.getComputedStyle){var r=t.replace(/([A-Z])/g,"-$1");return r=t.toLowerCase(),document.defaultView.getComputedStyle(e,null)[r]}return null},getElementAbsPos:function(e){for(var t=e.offsetTop,r=e.offsetLeft;e=e.offsetParent;)t+=e.offsetTop,r+=e.offsetLeft;return{left:r,top:t}},removeInlineStyle:function(e,t){var r,n=0,o=0,i=["-left","-top","-right","-bottom"];for("string"==typeof t&&(t=[t]),n;n<t.length;n++)if(e.style.removeProperty)e.style.removeProperty(t[n]);else if(t[n].match(/border/))for(o;o<i.length;o++)r=t[n].replace(/(border)/,"$1"+i[o]),r=r.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),e.style.removeAttribute(r);else t[n]=t[n].replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),e.style.removeAttribute(t[n])},addCookie:function(t,r,n){i.put(t,r),n||(n=.5),r=e.toJson(r);var o=t+"="+r;if(n>0){var a=new Date,s=3600*n*1e3;a.setTime(a.getTime()+s),o+="; expires="+a.toGMTString()}document.cookie=o}};var s=new a;return window._G=s,s}]).directive("rdSwitch",function(){function t(e,t){t.switchType=t.switchType||"type",t.activeClass=t.activeClass||"active",e.switchAction=e.switchAction||function(){}}return{scope:{activeType:"@",switchAction:"&",categories:"="},link:function(r,n,o){function i(){void 0!=r.activeType&&e.forEach(a,function(t){var n=e.element(t);n.attr(o.switchType)==r.activeType&&(a.removeClass(o.activeClass),n.addClass(o.activeClass))}),o.switchInit&&setTimeout(function(){e.forEach(a,function(t){var n=e.element(t);n.attr(o.switchType)==r.activeType&&(a.removeClass(o.activeClass),n.addClass(o.activeClass),r.switchAction({switchType:o.switchInit}))})},"800"),a.on("click",function(){var t=e.element(this);a.removeClass(o.activeClass),t.addClass(o.activeClass);var n={};n[o.switchType]=t.attr(o.switchType),r.switchAction(n)})}t(r,o);var a=n.children();i(),r.$watch("categories",function(e,t){e&&(a=n.children(),i())})}}}).directive("confirmInsert",function(){return{require:"ngModel",link:function(e,t,r,n){var o;e.$watch(r.confirmInsert,function(){o&&n.$setViewValue(o)}),n.$parsers.push(function(t){n.$setValidity("repeatCode",t==e.$eval(r.confirmInsert)),o=t})}}}).directive("formatNum",function(){return{require:"ngModel",scope:{formatValue:"&formatValue"},link:function(e,t,r,n){t[0].onkeyup=function(){e.formatValue()}}}}).directive("remoteValidation",["$http",function(e){return{require:"ngModel",link:function(t,r,n,o){var i=n.remote.split("/"),a={};r.bind("focus",function(){o.$setValidity(i[1],!0)}),r.bind("blur",function(){t.$eval(n.ngModel)&&(a[i[0]]=t.$eval(n.ngModel),e({method:"post",url:n.remoteValidation,params:a,headers:{"Content-Type":"application/x-www-form-urlencoded","x-requested-with":"XMLHttpRequest"}}).success(function(e){"true"==e||""==e?o.$setValidity(i[1],!0):o.$setValidity(i[1],!1)}).error(function(e,t,r,n){o.$setValidity(i[1],!1)}))})}}}]).directive("popTipbox",function(){function e(e){e.on("mouseleave",function(){e.children()[1].style.display="none"}),e.on("mouseenter",function(){e.children()[1].style.display="block"})}return{restrict:"A",transclude:!0,template:'<span ng-transclude></span><div class="poptip"><p class="poptipMain"></p><p class="poptipArrow"></p></div>',link:function(t,r,n,o){r.css("position","relative"),r[0].children[1].children[0].innerHTML=n.popTipbox;var i,a,s=r.children()[1];1==n.index?(s.style.bottom="27px",s.children[0].style.whiteSpace="nowrap"):2==n.index?(13.5*n.popTipbox.length>250?s.style.width="250px":s.style.width=13.5*n.popTipbox.length,i=s.offsetWidth,s.style.bottom="40px"):s.children[0].style.whiteSpace="nowrap",i=s.offsetWidth,a=r[0].offsetWidth,2==n.index?s.style.left=(a-i)/2-80+"px":s.style.left=(a-i)/2+"px",s.children[1].style.left=i/2-7+"px",r.children()[1].style.display="none",e(r)}}})}});