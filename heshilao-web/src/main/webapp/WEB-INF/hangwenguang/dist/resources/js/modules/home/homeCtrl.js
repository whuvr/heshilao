define(["angular"],function(o){return function(r,e,a,n){r.controller("homeCtrl",["$scope","navData","cService","$rootScope","$cookieStore","$state",function(r,e,a,n,t,s,c){"use strict";r.loginNum=!1,r.serverError=!1,r.sendAgainShow=!1,r.callError="",r.user.password="",r.navDate=e[0].subState,r.bondData=[],r.investData=[],r.company="",r.captcha="validCode?t="+Math.random(),r.validCodeFn=function(){r.captcha="validCode?t="+Math.random()},r.focus=function(){r.serverError=!1,r.sendAgainShow=!1},r.validCode=function(){document.getElementById("reg-validatecode")&&(document.getElementById("reg-validatecode").src="validCode?t="+Math.random())},r.sendAgain=function(){a.ajax({url:"users/sentActivateEmail?username="+r.user.username1,method:"get"}).success(function(o,r,e,a){alert("邮件已发送")})},r.submit=function(e){r.serverError=!1;var s=o.element(document.getElementById("password")),c=fieldRSA(s),l={};l=0==r.loginNum?{username:r.user.username1,password:c}:{username:r.user.username1,password:c,validCode:r.user.validCode1},a.ajax({url:"users/login",method:"post",params:l}).success(function(o,e,a,s){r.loginFalse=!1,r.loginSucc=!0;var c=a("lastlockcount"),l=a("isLock"),u=parseInt(c)+1;r.totalLockCount=r.totalLockCount>u?r.totalLockCount:u,null!=a("count")&&(r.loginNum=!0),l||null!=c&&0>=c?(r.callError="密码输错超过"+r.totalLockCount+"次，您的账户被锁定",r.serverError=!0):c&&c<=r.totalLockCount-2&&(r.callError="您还有"+c+"次密码输入机会",r.serverError=!0),""!=o?(n.user=o,t.put("curUser",o),n.login.beforeLogin=!1,n.login.afterLogin=!0):(r.serverError||(r.callError="用户名或者密码错误",r.serverError=!0),document.getElementById("reg-validatecode")&&r.validCode())}).error(function(o,e,a,n){"8004"==o.code?r.sendAgainShow=!0:(r.validCode(),r.callError=o.message,r.serverError=!0)})},a.ajax({url:"column/scrollImages"}).success(function(o,e,a,n){r.data=o.rows}).error(function(o,r,e,a){console.log(o)}),a.ajax({url:"column/partners"}).success(function(o,e,a,n){r.data1=o.rows}).error(function(o,r,e,a){console.log(o)}),a.ajax({url:"statistics/count"}).success(function(o,e,a,n){r.countData=o,r.trading=o.sumInvestmentAmount;var t=r.trading.split("");r.strs=[];for(var s=0;s<t.length;s++)r.strs.push({value:t[s]})}).error(function(o,r,e,a){console.log(o)}),a.ajax({url:"borrows/prefecture"}).success(function(o,e,a,n){r.newPalyerData=o.newPalyerBorrow,r.recommendData=o.recommendBorrow}).error(function(o,r,e,a){console.log(o)}),a.ajax({url:"bond/bonds/bondList",params:{status:-3,page:1,rows:4}}).success(function(o,e,a,n){r.bondData=o.rows}).error(function(o,r,e,a){console.log(o)}),a.ajax({url:"borrows/index"}).success(function(o,e,a,n){r.investData=o.rows.slice(0,3)}).error(function(o,r,e,a){console.log(o)}),a.ajax({url:"borrows/selectforRecommendByCategory",params:{page:1,rows:4}}).success(function(o,e,a,n){var t=[9.8,7,9,5],s=[11.8,10,11,10],c=[{name:"新手礼遇",borrowName:""},{name:"艺术品金融",borrowName:""},{name:"梦想计划",borrowName:""},{name:"创业车贷",borrowName:""}],l=o.length;o.length||(l=4);for(var u=0;4>u;u++)for(var i=0;l>i;i++)o[i]&&o[i].categoryName==c[u].name?(c[u].rateYearMin=t[u],c[u].rateYearMax=s[u],c[u].borrowName=o[i].borrowName):(c[u].rateYearMin=t[u],c[u].rateYearMax=s[u]);r.investData1=c}).error(function(o,r,e,a){console.log(o)}),a.ajax({url:"statistics/investRank"}).success(function(o,e,a,n){r.totalRankData=o.totalRank,r.monthRankData=o.monthRank}).error(function(o,r,e,a){console.log(o)}),a.ajax({url:"investments/dynamiceInvest",method:"post"}).success(function(o,e,a,n){r.dynamiceData=o}).error(function(o,r,e,a){console.log(o)}),a.ajax({url:"column/articles/1",method:"post",params:{page:1,rows:1}}).success(function(o,e,a,n){r.articleData=o.rows}).error(function(o,r,e,a){console.log(o)}),a.ajax({method:"post",url:"column/articles/1",params:{page:1,rows:5}}).success(function(o,e,a,n){r.articlesData=o.rows}).error(function(o,r,e,a){console.log(o)}),a.ajax({method:"post",url:"column/articles/2",params:{page:1,rows:3}}).success(function(o,e,a,n){r.article2Data=o.rows}).error(function(o,r,e,a){console.log(o)})}])}});