define(["angular"],function(t){return function(t,e,a,n){t.controller("backCtrl",["navData","$scope","cService","$location","popupDialog",function(t,e,a,n,o){"use strict";e.page=1,e.pageSize=10,e.status="",e.time=-1,e.changeTime=function(){if(""==e.time)e.searchDate=!0;else{e.searchDate=!1;var t=document.getElementById("startTime"),a=document.getElementById("endTime");t.value="",a.value=""}};var c,u,i=e.time;e.change=function(t,n){var o=document.getElementById("startTime"),r=document.getElementById("endTime");n||(i=e.time,c=o.value,u=r.value),a.ajax({url:"repayments",params:{page:t,rows:10,status:e.status,time:i,startTime:c,endTime:u}}).success(function(t,a,o,c){e.data=t.rows,e.total=t.total,1!=n&&(e.page=1)}).error(function(t,e,a,n){console.log(t)})};var r;e.backto=function(t,n,c){e.actualAmount=n.actualAmount,e.capital=n.capital,e.interest=n.interest,e.overdueInterest=n.overdueInterest,r=o("template_payBack",e,{title:"还款提示",closeBtn:!1,buttons:[],type:"no-icon",ajax:function(){return a.ajax({url:"repayments",method:"post",params:{id:c}}).success(function(t){e.paid=!0,t?(e.payUrl=t,e.payback=function(){e.paid=!1}):e.payback=function(){e.paid=!0,a.ajax({url:"repayments/corpRepay?id="+c}).success(function(t,e,a,n){r.close(r);alert("恭喜您，已成功完成还款！",{buttons:[{type:"button",value:"确定",callBack:function(){location.reload()}}]})}).error(function(t,e,a,n){alert("抱歉，本次还款失败，请重试！如无法解决，请联系客服（客服热线）！",{buttons:[{type:"button",value:"确定",callBack:function(){location.reload()}}]})})}})}})},e.close=function(){r.close(r)},e.reload=function(){location.reload()}}])}});