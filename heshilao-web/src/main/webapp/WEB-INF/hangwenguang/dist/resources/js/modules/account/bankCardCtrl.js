define(["angular"],function(){return function(t,n,a,o){t.controller("bankCardCtrl",["$scope","cService","$rootScope","$window","$location","$state","popupDialog","$cookieStore",function(t,n,a,o,e,c,i,u){var l=u.get("curUser");t.identifyUrl="",t.identify_cont="这里是显示内容",t.identify_btn_value="跳到第三方",t.status5=!1,t.cardBindding=!1,t.realName=!1,t.payMiddle="",t.user={bankNo:"",bank:""},t.tab={},t.change=!1,t.formData={},t.formData.name=a.user.realName,t.formData.province="北京",t.formData.city="海淀区",t.formData.account="",t.formData.bank="ICBC",t.formData.confirmAccount="",t.bankListView=!1,t.bankList=[],t.insertNum=function(t,n){var a=document.getElementById(n);39!=t.keyCode&&37!=t.keyCode&&(a.value=a.value.replace(/[^\d]/g,""))},t.searchBank=function(a){t.bankListView=!1,n.ajax({url:"user/cardBind/repaceCard?id="+a,method:"get"}).success(function(n,a,o,e){t.bankList=n,t.formData.bank=t.bankList[0].dictCode;for(var c=t.bankList.length,i=0;c>i;i++)t.tab["on"+i]=!1;t.tab.on0=!0})},t.selectBank=function(n){t.formData.bank=n.item,t.bankListView=!1},t.checkBank=function(n){t.formData.bank=t.bankList[n].dictCode;for(var a=t.bankList.length,o=0;a>o;o++)t.tab["on"+o]=!1;t.tab["on"+n]=!0},t.setBank=function(){console.log(t.selected)},t.changeBank=function(n){t.searchBank(n),t.change=!0,t.selected=""},t.init=function(){n.ajax({url:"user/cardBind/getBindBank"}).success(function(a,o,e,i){t.bankLi=a,0==a.length?c.go("account.bankCard.formShow"):c.go("account.bankCard.cardShow"),n.ajax({url:"account/paymentaccount/getNamePhone"}).success(function(n,a,o,e){for(var c=0;c<t.bankLi.length;c++)1==n.tppType||1==t.bankLi[c].isopenfastPayment&&2==n.tppType?t.hideblank={display:"none"}:t.hideblank={display:"inline-block"}})})},t.submitAdd=function(){alert("请前往新打开窗口去完成绑卡操作，绑卡完成前不要关掉本窗口！",{buttons:[{type:"button",value:"绑卡成功",callBack:function(){window.location.reload()}},{type:"button",value:"绑卡失败",callBack:function(){window.location.reload()}}]})},t.submitReplace=function(t,n){1==n?(msg="请前往新打开窗口去完成更换银行卡操作，更换银行卡完成前不要关掉本窗口！",alert(msg,{buttons:[{type:"button",value:"绑卡成功",callBack:function(){window.location.reload()}},{type:"button",value:"绑卡失败",callBack:function(){window.location.reload()}}]})):2==n&&(msg="请前往新打开窗口去完成解绑银行卡操作，解绑银行卡完成前不要关掉本窗口！",alert(msg,{buttons:[{type:"button",value:"解绑成功",callBack:function(){window.location.reload()}},{type:"button",value:"解绑失败",callBack:function(){window.location.reload()}}]}))},t.submit=function(a){t.change?n.ajax({url:"user/cardBind/repaceCard?bank="+t.formData.bank+"&bankNo="+t.formData.account}).success(function(n,a){t.identifyUrl=n,t.identify_cont="这里是显示内容",t.identify_btn_value="跳到第三方";i("template_identify",t,{buttons:[],closeBtn:!0})}).error(function(t,n){alert(t.message),w.close()}):n.ajax({url:"user/cardBind/bindCard?bank="+t.formData.bank+"&bankNo="+t.formData.account}).success(function(n,a){t.identifyUrl=n,t.identify_cont="这里是显示内容",t.identify_btn_value="跳到第三方";i("template_identify",t,{buttons:[],closeBtn:!0})}).error(function(n,a){t.identifyUrl=n,t.identify_cont="这里是显示内容",t.identify_btn_value="跳到第三方";i("template_identify",t,{buttons:[],closeBtn:!0})})},0==l.realNameStatus?(c.go("account.bankCard.formShow"),alert("您尚未进行实名认证，请先去实名认证",{closeBtn:!1,buttons:[{type:"button",value:"去实名认证",callBack:function(){c.go("account.payAccount")}}]})):5!=l.realNameStatus||1!=l.userType&&2!=l.userType?3==l.realNameStatus?alert("温馨提示：如您未开启投标授权、还款转账授权、二次分配审核授权，</br>请先至第三方页面开启授权；若您已开启授权，无需重复操作。",{closeBtn:!1,type:"info",buttons:[{type:"button",value:"去授权",callBack:function(){var t=o.open();n.ajax({url:"users/authSign",method:"get"}).success(function(n){t.location=n,alert("温馨提示：如您未开启投标授权、还款转账授权、二次分配审核授权，</br>请先至第三方页面开启授权；若您已开启授权，无需重复操作",{buttons:[{type:"button",value:"授权成功",callBack:function(){window.location.reload()}},{type:"button",value:"授权失败",callBack:function(){window.location.reload()}}]})}).error(function(){t.close()})}}]}):t.init():t.status5=!0,t.openQuickPayment=function(){alert("温馨提示：前往第三方开通快捷支付中，请勿关闭此页面。",{buttons:[{type:"button",value:"开通成功",callBack:function(){c.go("account.payAccount")}},{type:"button",value:"开通失败",callBack:function(){c.go("account.payAccount")}}]})}}])}});